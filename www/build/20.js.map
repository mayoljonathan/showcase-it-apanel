{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts","../../node_modules/email-validator/index.js"],"names":[],"mappings":"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","file":"20.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LoginPage } from './login';\n\n@NgModule({\n  declarations: [\n    LoginPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n  ],\n})\nexport class LoginPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams,MenuController } from 'ionic-angular';\n\nimport * as EmailValidator from 'email-validator';\n\nimport { Admin } from \"../../shared/models/\";\nimport { AdminService,CacheService } from \"../../shared/services/\";\n\nimport { DialogUtil } from \"../../shared/utils/\";\n\n\n@IonicPage()\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html',\n})\nexport class LoginPage {\n\n  admin : Admin;\n\n  constructor(\n    public navCtrl: NavController, \n    public navParams: NavParams,\n    public menuCtrl: MenuController,\n    public cacheService: CacheService,\n    public dialogUtil: DialogUtil,\n    public adminService: AdminService  \n  ) {\n    this.admin = new Admin();\n    // this.admin.email = 'showcase.it.team@gmail.com';\n    // this.admin.password = 'abc123';\n    this.admin.email = '';\n    this.admin.password = '';\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad LoginPage');\n  }\n\n  signIn(){\n    if(!this.admin.email){\n      this.dialogUtil.showToast('Please input your email address.', 3000, 'bottom');\n    }else if(!EmailValidator.validate(this.admin.email)){\n      this.dialogUtil.showToast('Email address is not valid.', 3000, 'bottom');\n    }else if(!this.admin.password){\n      this.dialogUtil.showToast('Please input your password.', 3000, 'bottom');\n    }else{\n      this.dialogUtil.showLoader('Signing in.');\n      this.adminService.signInWithEmail(this.admin).then(res=>{\n        // If credentials are correct in authentication\n        if(res){\n          this.adminService.getAdminData(res.uid).then((adminData:Admin)=>{\n            // No credentials found in firebase db\n            if(!adminData){\n              this.adminService.signOut();\n              return this.dialogUtil.showAlert('There are no users found in your credentials.','Ok');\n            }\n            // If credentials found in firebase db\n            if(adminData.status === 'disabled'){\n              this.dialogUtil.showAlert('Your account has been disabled by the Super admin.', 'Ok');\n              this.adminService.signOut();\n            }else if(adminData.status === 'active'){\n              this.dialogUtil.showToast(`Welcome ${adminData.name}!`, 3000, 'bottom');\n              this.navCtrl.setRoot('DashboardPage');\n              setTimeout(()=>{\n                this.menuCtrl.enable(true);\n              });\n            }else{\n              this.dialogUtil.showAlert('Unable to sign in this account. Please contact the Super admin.', 'Ok');\n              this.adminService.signOut();\n            }\n          });\n        }\n        this.dialogUtil.hideLoader();\n      },error=>{\n        let msg = error.message;\n        if(error['code'] === 'auth/user-not-found'){\n          msg = `The email address you've entered doesn't match any account.`;\n        }else if(error['code'] === 'auth/user-disabled'){\n          msg = `Your account has been disabled by the Super admin.`;\n        }\n        this.dialogUtil.showAlert(msg,'Ok');\n        this.dialogUtil.hideLoader();\n      });\n    }\n\n  }\n\n  forgotPassword(){\n    new Promise((resolve,reject)=>{\n      let promptTitle = 'Forgot password';\n      let promptMsg = 'Please enter your email address so that we can send a password reset link.';\n      let inputs = {\n        name: 'email',\n        placeholder: 'Email address',\n        value: this.admin.email\n      };\n      let buttons = [\n        { text: 'Cancel', handler: reject },\n        { text: 'Send', handler: resolve },\n      ];\n      this.dialogUtil.showPrompt(promptTitle,promptMsg,inputs,buttons);\n    }).then((data:any)=>{\n      if(!EmailValidator.validate(data.email)){\n        this.dialogUtil.showToast('Email address is not valid.', 3000, 'bottom');\n      }else if(!data.email){\n        this.dialogUtil.showToast('Please input your email address.', 3000, 'bottom');\n      }else{\n        this.dialogUtil.showLoader('Sending a password reset link.');\n        this.adminService.sendPasswordReset(data.email).then(()=>{\n          this.dialogUtil.showToast(`Password reset link successfully sent to ${data.email}`, 4000,'bottom');\n          this.dialogUtil.hideLoader();\n        },()=>{\n          this.dialogUtil.showToast('Error in sending a password reset link.', 3000, 'bottom');\n          this.dialogUtil.hideLoader();\n        });\n      }\n    },()=>{});\n  }\n\n  ionViewCanEnter(){\n      return !this.cacheService.isLoggedIn && this.cacheService.isDoneCheckingAdminData ? true : false;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts","\"use strict\";\n\nvar tester = /^[-!#$%&'*+\\/0-9=?A-Z^_a-z{|}~](\\.?[-!#$%&'*+\\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-?\\.?[a-zA-Z0-9])*\\.[a-zA-Z](-?[a-zA-Z0-9])+$/;\n// Thanks to:\n// http://fightingforalostcause.net/misc/2006/compare-email-regex.php\n// http://thedailywtf.com/Articles/Validating_Email_Addresses.aspx\n// http://stackoverflow.com/questions/201323/what-is-the-best-regular-expression-for-validating-email-addresses/201378#201378\nexports.validate = function(email)\n{\n\tif (!email)\n\t\treturn false;\n\t\t\n\tif(email.length>254)\n\t\treturn false;\n\n\tvar valid = tester.test(email);\n\tif(!valid)\n\t\treturn false;\n\n\t// Further checking of some things regex can't handle\n\tvar parts = email.split(\"@\");\n\tif(parts[0].length>64)\n\t\treturn false;\n\n\tvar domainParts = parts[1].split(\".\");\n\tif(domainParts.some(function(part) { return part.length>63; }))\n\t\treturn false;\n\n\treturn true;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/email-validator/index.js\n// module id = 1346\n// module chunks = 20"],"sourceRoot":""}